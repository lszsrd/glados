<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
-- EPITECH PROJECT, 2025
-- Generic Language And Data Operand Syntax
-- File description:
-- lib/frontend/rizz/ParserBinaryExpr.hs
-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Module      : ParserBinaryExpr</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Description : Parses binary operation expressions with operator precedence.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- License     : MIT</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Maintainer  : maxence.pierre@epitech.eu hugo.duda@epitech.eu</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Parsing of binary operation expressions</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- If an unexpected token is found or the syntax is invalid, the parsing functions return an error message.</span><span>
</span><span id="line-18"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ParserBinaryExpr</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="ParserBinaryExpr.html#parseBinaryOpExpr"><span class="hs-identifier">parseBinaryOpExpr</span></a></span><span>
</span><span id="line-21"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ast.html"><span class="hs-identifier">Ast</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Tokens.html"><span class="hs-identifier">Tokens</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="ParserHelper.html"><span class="hs-identifier">ParserHelper</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">type</span><span> </span><span id="SingleToken"><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-var">SingleToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Token"><span class="hs-identifier hs-type">T.Token</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span id="local-6989586621679033326"><span class="annot"><a href="#local-6989586621679033326"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679033326"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-31"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'(A.BinaryOpParm, [SingleToken])'@</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- On success, this function returns a parsed BinaryOpParm.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- representing a single parameter in a BinaryOpExpr</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- </span><span>
</span><span id="line-36"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-37"></span><span class="annot"><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-type">parseBinaryOpParm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ast.html#Decl"><span class="hs-identifier hs-type">A.Decl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Ast.html#BinaryOpParm"><span class="hs-identifier hs-type">A.BinaryOpParm</span></a></span><span>
</span><span id="line-38"></span><span id="parseBinaryOpParm"><span class="annot"><span class="annottext">parseBinaryOpParm :: Decl -&gt; Parser BinaryOpParm
</span><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-var hs-var">parseBinaryOpParm</span></a></span></span><span> </span><span id="local-6989586621679033328"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033328"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679033329"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033329"><span class="hs-identifier hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033329"><span class="hs-identifier hs-var">tokens</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033333"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033333"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033334"><span class="annot"><span class="annottext">BinaryOpExpr
</span><a href="#local-6989586621679033334"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033335"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033335"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpExpr
</span><a href="ParserBinaryExpr.html#parseFormBinaryOpExpr"><span class="hs-identifier hs-var">parseFormBinaryOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033328"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033333"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-41"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033337"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033337"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; String -&gt; Parser ()
</span><a href="ParserHelper.html#expectToken"><span class="hs-identifier hs-var">H.expectToken</span></a></span><span>
</span><span id="line-42"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RBracket -&gt; Punctuator
</span><a href="Tokens.html#RBracket"><span class="hs-identifier hs-var">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#CloseRBracket"><span class="hs-identifier hs-var">T.CloseRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected ')'&quot;</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033335"><span class="hs-identifier hs-var">rest1</span></a></span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><span class="annottext">(BinaryOpParm, [SingleToken])
-&gt; Either String (BinaryOpParm, [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOpExpr -&gt; BinaryOpParm
</span><a href="Ast.html#BinaryOpParmBOp"><span class="hs-identifier hs-var">A.BinaryOpParmBOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOpExpr
</span><a href="#local-6989586621679033334"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033337"><span class="hs-identifier hs-var">rest2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033341"><span class="annot"><span class="annottext">ParmCallDecl
</span><a href="#local-6989586621679033341"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033342"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033342"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser ParmCallDecl
</span><a href="ParserHelper.html#parseParmCallDecl"><span class="hs-identifier hs-var">H.parseParmCallDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033328"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033329"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><span class="annottext">(BinaryOpParm, [SingleToken])
-&gt; Either String (BinaryOpParm, [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParmCallDecl -&gt; BinaryOpParm
</span><a href="Ast.html#BinaryOpParm"><span class="hs-identifier hs-var">A.BinaryOpParm</span></a></span><span> </span><span class="annot"><span class="annottext">ParmCallDecl
</span><a href="#local-6989586621679033341"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033342"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-49"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'(A.BinaryOpExpr, [SingleToken])'@</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- On success, this function returns a parsed BinaryOpExpr.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- </span><span>
</span><span id="line-53"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-54"></span><span class="annot"><a href="ParserBinaryExpr.html#parseFormBinaryOpExpr"><span class="hs-identifier hs-type">parseFormBinaryOpExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ast.html#Decl"><span class="hs-identifier hs-type">A.Decl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Ast.html#BinaryOpExpr"><span class="hs-identifier hs-type">A.BinaryOpExpr</span></a></span><span>
</span><span id="line-55"></span><span id="parseFormBinaryOpExpr"><span class="annot"><span class="annottext">parseFormBinaryOpExpr :: Decl -&gt; Parser BinaryOpExpr
</span><a href="ParserBinaryExpr.html#parseFormBinaryOpExpr"><span class="hs-identifier hs-var hs-var">parseFormBinaryOpExpr</span></a></span></span><span> </span><span id="local-6989586621679033345"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033345"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679033346"><span class="annot"><span class="annottext">tokens :: [SingleToken]
</span><a href="#local-6989586621679033346"><span class="hs-identifier hs-var">tokens</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span> </span><span id="local-6989586621679033348"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033348"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033349"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033349"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033350"><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033350"><span class="hs-identifier hs-var">parm1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpParm
</span><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-var">parseBinaryOpParm</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033345"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033346"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033351"><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033351"><span class="hs-identifier hs-var">parm2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033352"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033352"><span class="hs-identifier hs-var">rest3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpParm
</span><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-var">parseBinaryOpParm</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033345"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033349"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">(BinaryOpExpr, [SingleToken])
-&gt; Either String (BinaryOpExpr, [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOpParm -&gt; BinaryOp -&gt; BinaryOpParm -&gt; BinaryOpExpr
</span><a href="Ast.html#BinaryOpExpr"><span class="hs-identifier hs-var">A.BinaryOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033350"><span class="hs-identifier hs-var">parm1</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033348"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033351"><span class="hs-identifier hs-var">parm2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033352"><span class="hs-identifier hs-var">rest3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="annot"><a href="ParserBinaryExpr.html#parseFormBinaryOpExpr"><span class="hs-identifier hs-var">parseFormBinaryOpExpr</span></a></span><span> </span><span id="local-6989586621679033354"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033354"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679033355"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033355"><span class="hs-identifier hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033356"><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033356"><span class="hs-identifier hs-var">parm1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033357"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033357"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpParm
</span><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-var">parseBinaryOpParm</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033354"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033355"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser BinaryOp
</span><a href="ParserHelper.html#parseBinaryOp"><span class="hs-identifier hs-var">H.parseBinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033357"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679033359"><span class="annot"><span class="annottext">ParmCallDecl
</span><a href="#local-6989586621679033359"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser ParmCallDecl
</span><a href="ParserHelper.html#parseParmCallDecl"><span class="hs-identifier hs-var">H.parseParmCallDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033354"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033355"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">(BinaryOpExpr, [SingleToken])
-&gt; Either String (BinaryOpExpr, [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParmCallDecl -&gt; BinaryOpExpr
</span><a href="Ast.html#BinaryOpConst"><span class="hs-identifier hs-var">A.BinaryOpConst</span></a></span><span> </span><span class="annot"><span class="annottext">ParmCallDecl
</span><a href="#local-6989586621679033359"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033357"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033361"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033361"><span class="hs-identifier hs-var">binop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033362"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033362"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679033363"><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033363"><span class="hs-identifier hs-var">parm2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033364"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033364"><span class="hs-identifier hs-var">rest3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpParm
</span><a href="ParserBinaryExpr.html#parseBinaryOpParm"><span class="hs-identifier hs-var">parseBinaryOpParm</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033354"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033362"><span class="hs-identifier hs-var">rest2</span></a></span><span>
</span><span id="line-67"></span><span>            </span><span class="annot"><span class="annottext">(BinaryOpExpr, [SingleToken])
-&gt; Either String (BinaryOpExpr, [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOpParm -&gt; BinaryOp -&gt; BinaryOpParm -&gt; BinaryOpExpr
</span><a href="Ast.html#BinaryOpExpr"><span class="hs-identifier hs-var">A.BinaryOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033356"><span class="hs-identifier hs-var">parm1</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033361"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOpParm
</span><a href="#local-6989586621679033363"><span class="hs-identifier hs-var">parm2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033364"><span class="hs-identifier hs-var">rest3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-70"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'([SingleToken], [SingleToken])'@</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- On success, this function returns a stream of token.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- representing inside the bracket of an expr.</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- (e.g: &quot;foo(bar)&quot;, &quot;(4 - 5)&quot; )</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- </span><span>
</span><span id="line-76"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-type">packBracket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span id="packBracket"><span class="annot"><span class="annottext">packBracket :: Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var hs-var">packBracket</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033366"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033366"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#CloseRBracket"><span class="hs-identifier hs-var">T.CloseRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033367"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033367"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033366"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033367"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="annot"><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033368"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033368"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033369"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033369"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033370"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033370"><span class="hs-identifier hs-var">blk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033371"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033371"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033369"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-comment">-- first (blk)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033372"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033372"><span class="hs-identifier hs-var">blk2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033373"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033373"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033371"><span class="hs-identifier hs-var">rest1</span></a></span><span> </span><span class="hs-comment">-- rest after )</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033368"><span class="hs-identifier hs-var">op</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033370"><span class="hs-identifier hs-var">blk</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033372"><span class="hs-identifier hs-var">blk2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033373"><span class="hs-identifier hs-var">rest2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="annot"><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033374"><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033374"><span class="hs-identifier hs-var">op</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033375"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033375"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033376"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033376"><span class="hs-identifier hs-var">blk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033377"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033377"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033375"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033374"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033376"><span class="hs-identifier hs-var">blk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033377"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="annot"><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-90"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'([SingleToken], [SingleToken])'@</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- On success, this function returns a stream of token.</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- representing a single parameter in the BinaryOpExpr.</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- (e.g: &quot;foo(bar)&quot;, &quot;9&quot;, &quot;(4 - 5)&quot; )</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- </span><span>
</span><span id="line-96"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-97"></span><span class="annot"><a href="ParserBinaryExpr.html#getFirstParam"><span class="hs-identifier hs-type">getFirstParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span id="getFirstParam"><span class="annot"><span class="annottext">getFirstParam :: Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#getFirstParam"><span class="hs-identifier hs-var hs-var">getFirstParam</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="annot"><a href="ParserBinaryExpr.html#getFirstParam"><span class="hs-identifier hs-var">getFirstParam</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033379"><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033379"><span class="hs-identifier hs-var">punct</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033380"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033379"><span class="hs-identifier hs-var">punct</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679033381"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033381"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033381"><span class="hs-identifier hs-var">op</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679033382"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033382"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="annot"><span class="annottext">Punctuator
</span><a href="Tokens.html#Semicolon"><span class="hs-identifier hs-var">T.Semicolon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033382"><span class="hs-identifier hs-var">op</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679033384"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033384"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033385"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033385"><span class="hs-identifier hs-var">param</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033386"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033386"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packBracket"><span class="hs-identifier hs-var">packBracket</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033384"><span class="hs-identifier hs-var">op</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033385"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033386"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679033387"><span class="annot"><span class="annottext">op :: SingleToken
</span><a href="#local-6989586621679033387"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#CloseRBracket"><span class="hs-identifier hs-var">T.CloseRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033387"><span class="hs-identifier hs-var">op</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">SingleToken
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033388"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033388"><span class="hs-identifier hs-var">param</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033389"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033389"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#getFirstParam"><span class="hs-identifier hs-var">getFirstParam</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033380"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033379"><span class="hs-identifier hs-var">punct</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033388"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033389"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-111"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'[SingleToken]'@</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- On success, this function returns a packed Binary Operation Expression.</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- That means, grouping the first param of the bigger fish.</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- </span><span>
</span><span id="line-116"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-117"></span><span class="annot"><a href="ParserBinaryExpr.html#packFirstParamH"><span class="hs-identifier hs-type">packFirstParamH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span id="packFirstParamH"><span class="annot"><span class="annottext">packFirstParamH :: [SingleToken] -&gt; Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packFirstParamH"><span class="hs-identifier hs-var hs-var">packFirstParamH</span></a></span></span><span> </span><span id="local-6989586621679033391"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033391"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span id="local-6989586621679033392"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033392"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033391"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033393"><span class="annot"><span class="annottext">a :: SingleToken
</span><a href="#local-6989586621679033393"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Identifier"><span class="hs-identifier hs-type">T.Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span>
</span><span id="line-120"></span><span>        </span><span id="local-6989586621679033395"><span class="annot"><span class="annottext">x :: SingleToken
</span><a href="#local-6989586621679033395"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033396"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033396"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033397"><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033397"><span class="hs-identifier hs-var">parm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033398"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033398"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [([SingleToken], Maybe BinaryOp)]
</span><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-var">packBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033396"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033393"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033397"><span class="hs-identifier hs-var">parm</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033398"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033392"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033391"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033392"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-126"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'[SingleToken]'@</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- On success, this function returns a packed Binary Operation Expression.</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- That means, grouping the first param of the bigger fish.</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- </span><span>
</span><span id="line-131"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-132"></span><span class="annot"><a href="ParserBinaryExpr.html#packFirstParam"><span class="hs-identifier hs-type">packFirstParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span id="packFirstParam"><span class="annot"><span class="annottext">packFirstParam :: Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packFirstParam"><span class="hs-identifier hs-var hs-var">packFirstParam</span></a></span></span><span> </span><span id="local-6989586621679033402"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033402"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033403"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033403"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033404"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033404"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#getFirstParam"><span class="hs-identifier hs-var">getFirstParam</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033402"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033403"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679033405"><span class="annot"><span class="annottext">x :: SingleToken
</span><a href="#local-6989586621679033405"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-type">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tokens.html#RBracket"><span class="hs-identifier hs-type">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033406"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033406"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679033407"><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033407"><span class="hs-identifier hs-var">parm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033408"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033408"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [([SingleToken], Maybe BinaryOp)]
</span><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-var">packBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033406"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><span class="annottext">([SingleToken], [SingleToken])
-&gt; Either String ([SingleToken], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleToken
</span><a href="#local-6989586621679033405"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SingleToken -&gt; [SingleToken] -&gt; [SingleToken]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033407"><span class="hs-identifier hs-var">parm</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033408"><span class="hs-identifier hs-var">rest1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033404"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packFirstParamH"><span class="hs-identifier hs-var">packFirstParamH</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033403"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033404"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-142"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'([([SingleToken], Maybe T.BinaryOp)], [SingleToken])'@</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- On success, this function returns a packed Binary Operation Expression.</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- That means, grouping one parameter with its following Operator Token, until the end of BinaryOpExpr.</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- </span><span>
</span><span id="line-147"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-148"></span><span class="annot"><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-type">packBinOpExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span id="packBinOpExpr"><span class="annot"><span class="annottext">packBinOpExpr :: Parser [([SingleToken], Maybe BinaryOp)]
</span><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-var hs-var">packBinOpExpr</span></a></span></span><span> </span><span id="local-6989586621679033409"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033409"><span class="hs-identifier hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033410"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033410"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033411"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033411"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [SingleToken]
</span><a href="ParserBinaryExpr.html#packFirstParam"><span class="hs-identifier hs-var">packFirstParam</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033409"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser BinaryOp
</span><a href="ParserHelper.html#parseBinaryOp"><span class="hs-identifier hs-var">H.parseBinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033411"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([([SingleToken], Maybe BinaryOp)], [SingleToken])
-&gt; Either String ([([SingleToken], Maybe BinaryOp)], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033410"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe BinaryOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033411"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033412"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033412"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033413"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033413"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679033414"><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033414"><span class="hs-identifier hs-var">restParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033415"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033415"><span class="hs-identifier hs-var">restBuffer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [([SingleToken], Maybe BinaryOp)]
</span><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-var">packBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033413"><span class="hs-identifier hs-var">rest1</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">([([SingleToken], Maybe BinaryOp)], [SingleToken])
-&gt; Either String ([([SingleToken], Maybe BinaryOp)], [SingleToken])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033410"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryOp -&gt; Maybe BinaryOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033412"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
-&gt; [([SingleToken], Maybe BinaryOp)]
-&gt; [([SingleToken], Maybe BinaryOp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033414"><span class="hs-identifier hs-var">restParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033415"><span class="hs-identifier hs-var">restBuffer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Takes two @'([SingleToken], Maybe T.BinaryOp)'@ as parameters</span><span>
</span><span id="line-158"></span><span class="hs-comment">--  and returns an @'Integer'@</span><span>
</span><span id="line-159"></span><span class="hs-comment">--</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- this function serves as a helper function to get the priority of operator.</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- (e.g:</span><span>
</span><span id="line-162"></span><span class="hs-comment">--      -&gt; &quot;4 / 2 + ...&quot; -&gt; priority is 1st operator, returns 0</span><span>
</span><span id="line-163"></span><span class="hs-comment">--      -&gt; &quot;4 - 2 * ...&quot; -&gt; priority is 2nd operator, returns 1</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- )</span><span>
</span><span id="line-165"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-type">getPrioOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-167"></span><span id="getPrioOp"><span class="annot"><span class="annottext">getPrioOp :: ([SingleToken], Maybe BinaryOp)
-&gt; ([SingleToken], Maybe BinaryOp) -&gt; Int
</span><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var hs-var">getPrioOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Mul"><span class="hs-identifier hs-var">T.Mul</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Div"><span class="hs-identifier hs-var">T.Div</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-169"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Mul"><span class="hs-identifier hs-var">T.Mul</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-170"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Div"><span class="hs-identifier hs-var">T.Div</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-171"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Mod"><span class="hs-identifier hs-var">T.Mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-172"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="Tokens.html#Mod"><span class="hs-identifier hs-var">T.Mod</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter,</span><span>
</span><span id="line-176"></span><span class="hs-comment">--  and returns a stream of @'SingleToken'@</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- this function serves as a helper function to regroup params inbetween parenthesis.</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- (e.g: &quot;4 - 2 -&gt; (4 - 2)&quot; )</span><span>
</span><span id="line-180"></span><span class="annot"><a href="ParserBinaryExpr.html#createBlockParam"><span class="hs-identifier hs-type">createBlockParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span id="createBlockParam"><span class="annot"><span class="annottext">createBlockParam :: [SingleToken] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#createBlockParam"><span class="hs-identifier hs-var hs-var">createBlockParam</span></a></span></span><span> </span><span id="local-6989586621679033421"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033421"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RBracket -&gt; Punctuator
</span><a href="Tokens.html#RBracket"><span class="hs-identifier hs-var">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#OpenRBracket"><span class="hs-identifier hs-var">T.OpenRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033421"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033421"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RBracket -&gt; Punctuator
</span><a href="Tokens.html#RBracket"><span class="hs-identifier hs-var">T.RBracket</span></a></span><span> </span><span class="annot"><span class="annottext">RBracket
</span><a href="Tokens.html#CloseRBracket"><span class="hs-identifier hs-var">T.CloseRBracket</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033421"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Takes a stream of @'([SingleToken], Maybe T.BinaryOp]'@ as parameter,</span><span>
</span><span id="line-186"></span><span class="hs-comment">--  representing the unformatted binaryOpExpr, composed of a parameter with a Maybe binary Operator</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- (e.g: &quot;foo(y) * 2 -&gt; [ [ (foo, (, y, )], Just Mul), ([2], Nothing)])&quot; )</span><span>
</span><span id="line-188"></span><span class="hs-comment">--  and returns a stream of @'SingleToken'@</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- this function returns a formatted stream of token, representing the formatted BinaryOpExpr.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-type">formatBinOpExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-type">T.BinaryOp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ParserBinaryExpr.html#SingleToken"><span class="hs-identifier hs-type">SingleToken</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span id="formatBinOpExpr"><span class="annot"><span class="annottext">formatBinOpExpr :: [([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var hs-var">formatBinOpExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033423"><span class="annot"><span class="annottext">first :: ([SingleToken], Maybe BinaryOp)
</span><a href="#local-6989586621679033423"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679033424"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033424"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679033425"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033425"><span class="hs-identifier hs-var">op1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033426"><span class="annot"><span class="annottext">second :: ([SingleToken], Maybe BinaryOp)
</span><a href="#local-6989586621679033426"><span class="hs-identifier hs-var">second</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679033427"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679033428"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033428"><span class="hs-identifier hs-var">op2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679033429"><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033429"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
-&gt; ([SingleToken], Maybe BinaryOp) -&gt; Int
</span><a href="ParserBinaryExpr.html#getPrioOp"><span class="hs-identifier hs-var">getPrioOp</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><a href="#local-6989586621679033423"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><a href="#local-6989586621679033426"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#createBlockParam"><span class="hs-identifier hs-var">createBlockParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033424"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOp -&gt; Punctuator
</span><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-var">T.BinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033425"><span class="hs-identifier hs-var">op1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOp -&gt; Punctuator
</span><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-var">T.BinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033428"><span class="hs-identifier hs-var">op2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033427"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#createBlockParam"><span class="hs-identifier hs-var">createBlockParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033429"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033424"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOp -&gt; Punctuator
</span><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-var">T.BinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033425"><span class="hs-identifier hs-var">op1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033424"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-201"></span><span>            </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#createBlockParam"><span class="hs-identifier hs-var">createBlockParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
</span><a href="#local-6989586621679033426"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">([SingleToken], Maybe BinaryOp)
-&gt; [([SingleToken], Maybe BinaryOp)]
-&gt; [([SingleToken], Maybe BinaryOp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033429"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span class="annot"><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679033430"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033430"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe BinaryOp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033430"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-203"></span><span class="annot"><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679033431"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033431"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679033432"><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033432"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679033433"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033433"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe BinaryOp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033431"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Punctuator -&gt; Token
</span><a href="Tokens.html#Punctuator"><span class="hs-identifier hs-var">T.Punctuator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinaryOp -&gt; Punctuator
</span><a href="Tokens.html#BinaryOp"><span class="hs-identifier hs-var">T.BinaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOp
</span><a href="#local-6989586621679033432"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [SingleToken] -&gt; (Int, Int)
</span><a href="ParserHelper.html#getPos"><span class="hs-identifier hs-var">H.getPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033433"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033433"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Takes a stream of @'SingleToken'@ as parameter</span><span>
</span><span id="line-208"></span><span class="hs-comment">--  and returns a __Either __ @'String'@ @'(A.BinaryOpExpr, [SingleToken])'@</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- On success, this function returns a parsed Binary Operation Expression.</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- in the case of a complex expr (e.g: '3 * 4 - 1 / foo(4 - 1)'),</span><span>
</span><span id="line-212"></span><span class="hs-comment">--      - automatically format the expression.</span><span>
</span><span id="line-213"></span><span class="hs-comment">--      - organise the expression and taking in account operator priorities.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- On failure, this function returns a pretty formatted error message.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="ParserBinaryExpr.html#parseBinaryOpExpr"><span class="hs-identifier hs-type">parseBinaryOpExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ast.html#Decl"><span class="hs-identifier hs-type">A.Decl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ParserBinaryExpr.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Ast.html#BinaryOpExpr"><span class="hs-identifier hs-type">A.BinaryOpExpr</span></a></span><span>
</span><span id="line-217"></span><span id="parseBinaryOpExpr"><span class="annot"><span class="annottext">parseBinaryOpExpr :: Decl -&gt; Parser BinaryOpExpr
</span><a href="ParserBinaryExpr.html#parseBinaryOpExpr"><span class="hs-identifier hs-var hs-var">parseBinaryOpExpr</span></a></span></span><span> </span><span id="local-6989586621679033434"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033434"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679033435"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033435"><span class="hs-identifier hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679033436"><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033436"><span class="hs-identifier hs-var">binOpPacked</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679033437"><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033437"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [([SingleToken], Maybe BinaryOp)]
</span><a href="ParserBinaryExpr.html#packBinOpExpr"><span class="hs-identifier hs-var">packBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033435"><span class="hs-identifier hs-var">tokens</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679033438"><span class="annot"><span class="annottext">binOpFormatted :: [SingleToken]
</span><a href="#local-6989586621679033438"><span class="hs-identifier hs-var hs-var">binOpFormatted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)] -&gt; [SingleToken]
</span><a href="ParserBinaryExpr.html#formatBinOpExpr"><span class="hs-identifier hs-var">formatBinOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[([SingleToken], Maybe BinaryOp)]
</span><a href="#local-6989586621679033436"><span class="hs-identifier hs-var">binOpPacked</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">Decl -&gt; Parser BinaryOpExpr
</span><a href="ParserBinaryExpr.html#parseFormBinaryOpExpr"><span class="hs-identifier hs-var">parseFormBinaryOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621679033434"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033438"><span class="hs-identifier hs-var">binOpFormatted</span></a></span><span> </span><span class="annot"><span class="annottext">[SingleToken] -&gt; [SingleToken] -&gt; [SingleToken]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SingleToken]
</span><a href="#local-6989586621679033437"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span></pre></body></html>